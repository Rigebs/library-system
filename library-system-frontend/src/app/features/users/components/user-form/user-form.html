<form [formGroup]="userForm" (ngSubmit)="onSubmit()">

    <div class="form-group">
        <label for="name">Nombre:</label>
        <input id="name" type="text" formControlName="name" />
        @if (userForm.get('name')?.invalid && userForm.get('name')?.touched) {
        <div class="error-message">El nombre es obligatorio (mínimo 3 caracteres).</div>
        }
    </div>

    <div class="form-group">
        <label for="email">Email:</label>
        <input id="email" type="email" formControlName="email" [attr.readonly]="isEditMode ? true : null" />
        @if (userForm.get('email')?.invalid && userForm.get('email')?.touched) {
        <div class="error-message">Formato de email inválido.</div>
        }
        @if (isEditMode) {
        <small>El email no se puede cambiar.</small>
        }
    </div>

    <div class="form-group">
        <label for="password">Contraseña {{ isEditMode ? '(Dejar vacío para no cambiar)' : '*' }}:</label>
        <input id="password" type="password" formControlName="password" />
        @if (userForm.get('password')?.invalid && userForm.get('password')?.touched) {
        <div class="error-message">La contraseña debe tener al menos 6 caracteres.</div>
        }
    </div>

    <div class="form-group">
        <label for="role">Rol:</label>
        <select id="role" formControlName="role">
            @for (role of roles; track role) {
            <option [value]="role">{{ role }}</option>
            }
        </select>
        @if (userForm.get('role')?.invalid && userForm.get('role')?.touched) {
        <div class="error-message">El rol es obligatorio.</div>
        }
    </div>

    <button type="submit" [disabled]="userForm.invalid || isLoading()">
        @if (isLoading()) {
        Guardando...
        } @else {
        {{ isEditMode ? 'Guardar Cambios' : 'Crear Usuario' }}
        }
    </button>
</form>