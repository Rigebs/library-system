<div class="container user-list-container">
    <header class="list-header">
        <h2>Panel de Administraci√≥n de Usuarios</h2>
        <div>
            <button [routerLink]="['/dashboard/create']" class="btn-create btn-icon">
                <img class="icon" src="/icons/user-plus.svg" alt="Crear Usuario">
                Crear Usuario
            </button>
        </div>
    </header>

    @if (error(); as errorMsg) {
    <div class="alert alert-error">
        Error al cargar la lista: {{ errorMsg }}
    </div>
    }
    @if (deleteError(); as delErrorMsg) {
    <div class="alert alert-error">
        Error al eliminar: {{ delErrorMsg }}
    </div>
    }

    @if (isLoading()) {
    <div class="loading-indicator">Cargando datos protegidos...</div>
    } @else {
    <div class="table-responsive">
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Email</th>
                    <th>Rol</th>
                    <th>Fecha Registro</th>
                    <th class="actions-column">Acciones</th>
                </tr>
            </thead>
            <tbody>
                @for (user of users(); track user.id) {
                <tr class="row" [class.is-deleting]="isDeleting()">
                    <td>{{ user.id }}</td>
                    <td>{{ user.name }}</td>
                    <td>{{ user.email }}</td>
                    <td>{{ user.role }}</td>
                    <td>{{ user.registrationDate | date:'shortDate' }}</td>
                    <td class="actions-column">
                        <button [routerLink]="['/dashboard/edit', user.id]" class="btn-edit btn-icon">
                            <img class="icon" src="/icons/edit.svg" alt="Editar">
                        </button>

                        <button (click)="onDelete(user.id)" [disabled]="isDeleting()" class="btn-delete btn-icon">
                            <img class="icon" src="/icons/delete.svg" alt="Eliminar">
                        </button>
                    </td>

                </tr>
                } @empty {
                <tr>
                    <td colspan="6" class="text-center">No se encontraron usuarios.</td>
                </tr>
                }
            </tbody>
        </table>
    </div>
    }
</div>